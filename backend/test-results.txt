
 RUN  v3.2.4 /home/gsvirgilli/Github/BRISA/BRISA/G07-SECTI/backend

 âœ“ test/simple.test.ts > Simple Test > deve passar um teste bÃ¡sico 2ms
 âœ“ test/simple.test.ts > Simple Test > deve testar strings 0ms
stdout | test/candidates.test.ts
[dotenv@17.2.2] injecting env (7) from .env -- tip: âš™ï¸  enable debug logging with { debug: true }

stdout | test/students.test.ts
[dotenv@17.2.2] injecting env (7) from .env -- tip: ğŸ› ï¸  run anywhere with `dotenvx run -- yourcommand`

stdout | test/courses-final.test.ts
[dotenv@17.2.2] injecting env (7) from .env -- tip: âš™ï¸  suppress all logs with { quiet: true }

stdout | test/classes.test.ts
[dotenv@17.2.2] injecting env (7) from .env -- tip: ğŸ” prevent building .env in docker: https://dotenvx.com/prebuild

stdout | test/health.test.ts
[dotenv@17.2.2] injecting env (7) from .env -- tip: ğŸ“¡ auto-backup env with Radar: https://dotenvx.com/radar

 âœ“ test/courses-final.test.ts > Courses API - Final Tests > âœ… Testes Funcionais > deve retornar erro 401 sem token 15ms
 âœ“ test/courses-final.test.ts > Courses API - Final Tests > âœ… Testes Funcionais > deve retornar erro 401 com token invÃ¡lido 2ms
 âœ“ test/courses-final.test.ts > Courses API - Final Tests > âœ… Testes Funcionais > deve listar cursos com sucesso 3ms
 âœ“ test/courses-final.test.ts > Courses API - Final Tests > âœ… Testes Funcionais > deve criar curso com dados vÃ¡lidos 7ms
 âœ“ test/courses-final.test.ts > Courses API - Final Tests > âœ… Testes Funcionais > deve retornar erro 400 para dados invÃ¡lidos 3ms
 âœ“ test/courses-final.test.ts > Courses API - Final Tests > âœ… Testes Funcionais > deve retornar estatÃ­sticas 2ms
 âœ“ test/courses-final.test.ts > Courses API - Final Tests > âœ… Testes Funcionais > deve retornar erro 400 para ID invÃ¡lido 2ms
 âœ“ test/health.test.ts > Healthcheck > GET /api/health deve responder 200 com status ok 11ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ” AutenticaÃ§Ã£o > deve retornar erro 401 sem token 12ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ” AutenticaÃ§Ã£o > deve retornar erro 401 com token invÃ¡lido 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ“‹ GET /api/classes - Listar Turmas > deve listar turmas com sucesso 3ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ“‹ GET /api/classes - Listar Turmas > deve listar turmas com filtro por nome 3ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ“‹ GET /api/classes - Listar Turmas > deve listar turmas com filtro por turno 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ“‹ GET /api/classes - Listar Turmas > deve listar turmas com filtro por curso 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ“‹ GET /api/classes - Listar Turmas > deve retornar lista vazia quando nÃ£o hÃ¡ turmas 1ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ” GET /api/classes/:id - Buscar Turma > deve buscar turma por ID com sucesso 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ” GET /api/classes/:id - Buscar Turma > deve retornar 404 quando turma nÃ£o existe 3ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > â• POST /api/classes - Criar Turma > deve criar turma com dados vÃ¡lidos 8ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > â• POST /api/classes - Criar Turma > deve retornar 400 sem nome 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > â• POST /api/classes - Criar Turma > deve retornar 400 com nome muito curto 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > â• POST /api/classes - Criar Turma > deve retornar 400 sem turno 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > â• POST /api/classes - Criar Turma > deve retornar 400 com turno invÃ¡lido 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > â• POST /api/classes - Criar Turma > deve retornar 400 sem id_curso 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > â• POST /api/classes - Criar Turma > deve retornar 404 quando curso nÃ£o existe 1ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > â• POST /api/classes - Criar Turma > deve retornar 400 quando data_fim Ã© anterior a data_inicio 1ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > âœï¸ PUT /api/classes/:id - Atualizar Turma > deve atualizar turma com sucesso 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > âœï¸ PUT /api/classes/:id - Atualizar Turma > deve retornar 404 quando turma nÃ£o existe 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > âœï¸ PUT /api/classes/:id - Atualizar Turma > deve atualizar apenas nome 1ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > âœï¸ PUT /api/classes/:id - Atualizar Turma > deve retornar 400 com turno invÃ¡lido 3ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ—‘ï¸ DELETE /api/classes/:id - Deletar Turma > deve deletar turma com sucesso 1ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ—‘ï¸ DELETE /api/classes/:id - Deletar Turma > deve retornar 404 quando turma nÃ£o existe 1ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ“Š GET /api/classes/statistics - EstatÃ­sticas > deve retornar estatÃ­sticas com sucesso 1ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > âš ï¸ POST /api/classes/check-conflict - Verificar Conflito > deve verificar conflito sem encontrar 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > âš ï¸ POST /api/classes/check-conflict - Verificar Conflito > deve verificar conflito e encontrar 1ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > âš ï¸ POST /api/classes/check-conflict - Verificar Conflito > deve verificar conflito excluindo turma especÃ­fica 2ms
 âœ“ test/classes.test.ts > Classes API - Testes Completos > ğŸ¯ Testes de IntegraÃ§Ã£o > deve listar, criar e buscar turma criada 4ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ” AutenticaÃ§Ã£o > deve retornar erro 401 sem token 17ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ” AutenticaÃ§Ã£o > deve retornar erro 401 com token invÃ¡lido 2ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ” AutenticaÃ§Ã£o > deve aceitar requisiÃ§Ã£o com token vÃ¡lido 3ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ“‹ GET /api/students - Listar Alunos > deve listar todos os alunos 3ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ“‹ GET /api/students - Listar Alunos > deve listar alunos com filtros 3ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ“‹ GET /api/students - Listar Alunos > deve retornar lista vazia quando nÃ£o hÃ¡ alunos 3ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ” GET /api/students/:id - Buscar Aluno por ID > deve buscar aluno por ID 4ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ” GET /api/students/:id - Buscar Aluno por ID > deve retornar 404 se aluno nÃ£o existir 3ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ” GET /api/students/cpf/:cpf - Buscar Aluno por CPF > deve buscar aluno por CPF 5ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ” GET /api/students/cpf/:cpf - Buscar Aluno por CPF > deve retornar 404 se aluno nÃ£o existir 3ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ” GET /api/students/matricula/:matricula - Buscar Aluno por MatrÃ­cula > deve buscar aluno por matrÃ­cula 2ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ” GET /api/students/matricula/:matricula - Buscar Aluno por MatrÃ­cula > deve retornar 404 se aluno nÃ£o existir 2ms
 âœ“ test/students.test.ts > Students API - Testes Completos > âœï¸ PUT /api/students/:id - Atualizar Aluno > deve atualizar aluno existente 14ms
 âœ“ test/students.test.ts > Students API - Testes Completos > âœï¸ PUT /api/students/:id - Atualizar Aluno > deve retornar 404 se aluno nÃ£o existir 3ms
 âœ“ test/students.test.ts > Students API - Testes Completos > âœï¸ PUT /api/students/:id - Atualizar Aluno > deve validar dados de atualizaÃ§Ã£o 3ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ—‘ï¸ DELETE /api/students/:id - Deletar Aluno > deve deletar aluno existente 2ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ—‘ï¸ DELETE /api/students/:id - Deletar Aluno > deve retornar 404 se aluno nÃ£o existir 2ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ“Š GET /api/students/statistics - EstatÃ­sticas > deve retornar estatÃ­sticas de alunos 1ms
 âœ“ test/students.test.ts > Students API - Testes Completos > ğŸ“Š GET /api/students/statistics - EstatÃ­sticas > deve retornar estatÃ­sticas vazias quando nÃ£o hÃ¡ alunos 1ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ” AutenticaÃ§Ã£o > deve retornar erro 401 sem token 20ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ” AutenticaÃ§Ã£o > deve retornar erro 401 com token invÃ¡lido 4ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ” AutenticaÃ§Ã£o > deve aceitar requisiÃ§Ã£o com token vÃ¡lido 5ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ“‹ GET /api/candidates - Listar Candidatos > deve listar todos os candidatos 5ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ“‹ GET /api/candidates - Listar Candidatos > deve listar candidatos com filtros 5ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ“‹ GET /api/candidates - Listar Candidatos > deve retornar lista vazia quando nÃ£o hÃ¡ candidatos 3ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ” GET /api/candidates/:id - Buscar Candidato > deve buscar candidato por ID 4ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ” GET /api/candidates/:id - Buscar Candidato > deve retornar 404 se candidato nÃ£o existir 3ms
 Ã— test/candidates.test.ts > Candidates API - Testes Completos > â• POST /api/candidates - Criar Candidato > deve criar um novo candidato 18ms
   â†’ expected 400 to be 201 // Object.is equality
 Ã— test/candidates.test.ts > Candidates API - Testes Completos > â• POST /api/candidates - Criar Candidato > deve validar campos obrigatÃ³rios 5ms
   â†’ expected { name: 'ZodError', â€¦(1) } to have property "details"
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > â• POST /api/candidates - Criar Candidato > deve validar formato de email 2ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > â• POST /api/candidates - Criar Candidato > deve validar CPF com 11 dÃ­gitos 1ms
 Ã— test/candidates.test.ts > Candidates API - Testes Completos > â• POST /api/candidates - Criar Candidato > deve retornar 409 se CPF jÃ¡ cadastrado 3ms
   â†’ expected 400 to be 409 // Object.is equality
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > âœï¸ PUT /api/candidates/:id - Atualizar Candidato > deve atualizar candidato existente 4ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > âœï¸ PUT /api/candidates/:id - Atualizar Candidato > deve retornar 404 se candidato nÃ£o existir 3ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > âœï¸ PUT /api/candidates/:id - Atualizar Candidato > nÃ£o deve permitir alterar status de candidato aprovado 3ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ—‘ï¸ DELETE /api/candidates/:id - Deletar Candidato > deve deletar candidato existente 3ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ—‘ï¸ DELETE /api/candidates/:id - Deletar Candidato > deve retornar 404 se candidato nÃ£o existir 2ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ—‘ï¸ DELETE /api/candidates/:id - Deletar Candidato > nÃ£o deve permitir deletar candidato aprovado 2ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > âœ… POST /api/candidates/:id/approve - Aprovar Candidato > deve aprovar candidato e converter em aluno 2ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > âœ… POST /api/candidates/:id/approve - Aprovar Candidato > deve retornar 404 se candidato nÃ£o existir 2ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > âœ… POST /api/candidates/:id/approve - Aprovar Candidato > deve retornar erro se candidato jÃ¡ foi aprovado 2ms
 Ã— test/candidates.test.ts > Candidates API - Testes Completos > âŒ POST /api/candidates/:id/reject - Rejeitar Candidato > deve rejeitar candidato com motivo 4ms
   â†’ expected 400 to be 200 // Object.is equality
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > âŒ POST /api/candidates/:id/reject - Rejeitar Candidato > deve validar campo motivo 2ms
 Ã— test/candidates.test.ts > Candidates API - Testes Completos > âŒ POST /api/candidates/:id/reject - Rejeitar Candidato > deve retornar 404 se candidato nÃ£o existir 2ms
   â†’ expected 400 to be 404 // Object.is equality
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > âŒ POST /api/candidates/:id/reject - Rejeitar Candidato > nÃ£o deve permitir rejeitar candidato aprovado 2ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ“Š GET /api/candidates/statistics - EstatÃ­sticas > deve retornar estatÃ­sticas de candidatos 1ms
 âœ“ test/candidates.test.ts > Candidates API - Testes Completos > ğŸ“Š GET /api/candidates/statistics - EstatÃ­sticas > deve retornar estatÃ­sticas vazias quando nÃ£o hÃ¡ candidatos 1ms

â¯â¯â¯â¯â¯â¯â¯ Failed Tests 5 â¯â¯â¯â¯â¯â¯â¯

 FAIL  test/candidates.test.ts > Candidates API - Testes Completos > â• POST /api/candidates - Criar Candidato > deve criar um novo candidato
AssertionError: expected 400 to be 201 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 201[39m
[31m+ 400[39m

 â¯ test/candidates.test.ts:219:31
    217|         .send(newCandidateData);
    218|       
    219|       expect(response.status).toBe(201);
       |                               ^
    220|       expect(response.body).toHaveProperty('id');
    221|       expect(response.body.nome).toBe(newCandidateData.nome);

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/5]â¯

 FAIL  test/candidates.test.ts > Candidates API - Testes Completos > â• POST /api/candidates - Criar Candidato > deve validar campos obrigatÃ³rios
AssertionError: expected { name: 'ZodError', â€¦(1) } to have property "details"
 â¯ test/candidates.test.ts:235:29
    233|       
    234|       expect(response.status).toBe(400);
    235|       expect(response.body).toHaveProperty('details');
       |                             ^
    236|       expect(response.body.details).toBeInstanceOf(Array);
    237|     });

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/5]â¯

 FAIL  test/candidates.test.ts > Candidates API - Testes Completos > â• POST /api/candidates - Criar Candidato > deve retornar 409 se CPF jÃ¡ cadastrado
AssertionError: expected 400 to be 409 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 409[39m
[31m+ 400[39m

 â¯ test/candidates.test.ts:277:31
    275|         .send(newCandidateData);
    276|       
    277|       expect(response.status).toBe(409);
       |                               ^
    278|     });
    279|   });

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/5]â¯

 FAIL  test/candidates.test.ts > Candidates API - Testes Completos > âŒ POST /api/candidates/:id/reject - Rejeitar Candidato > deve rejeitar candidato com motivo
AssertionError: expected 400 to be 200 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 200[39m
[31m+ 400[39m

 â¯ test/candidates.test.ts:428:31
    426|         .send(rejectData);
    427|       
    428|       expect(response.status).toBe(200);
       |                               ^
    429|       expect(response.body).toHaveProperty('message');
    430|       expect(CandidateService.reject).toHaveBeenCalledWith(1, rejectDaâ€¦

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[4/5]â¯

 FAIL  test/candidates.test.ts > Candidates API - Testes Completos > âŒ POST /api/candidates/:id/reject - Rejeitar Candidato > deve retornar 404 se candidato nÃ£o existir
AssertionError: expected 400 to be 404 // Object.is equality

[32m- Expected[39m
[31m+ Received[39m

[32m- 404[39m
[31m+ 400[39m

 â¯ test/candidates.test.ts:452:31
    450|         .send(rejectData);
    451|       
    452|       expect(response.status).toBe(404);
       |                               ^
    453|     });
    454| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[5/5]â¯


 Test Files  1 failed | 5 passed (6)
      Tests  5 failed | 80 passed (85)
   Start at  12:18:24
   Duration  847ms (transform 427ms, setup 0ms, collect 2.64s, tests 317ms, environment 1ms, prepare 377ms)

